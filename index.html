<html>
	<head>
	<meta charset="UTF-8">
	<title>GeeMail Inbox</title>
		<script src="js/mail-generator.js"></script>
		<link href="css/style.css" rel="stylesheet" media="screen">
       <link rel="icon" href="/img/favicon.ico" type="image/gif"> 
    <script>
      window.onload = function(){

      	function mail(messages){
      		for(var i=0; i<messages.length; i++){
            console.log(messages[i]);
            console.log(messages[i].sender);
            console.log(messages[i].subject);
            console.log(messages[i].date);
            console.log(messages[i].body);

            var emailElement = document.createElement('div');
            emailElement.className='email';
            document.getElementById('main').appendChild(emailElement);

            var senderElement = document.createElement('div');
            senderElement.className='sender';
            senderElement.innerHTML=messages[i].sender;
            emailElement.appendChild(senderElement);

            var subjectElement = document.createElement('div');
            subjectElement.className='subject';
            subjectElement.innerHTML=messages[i].subject;
            senderElement.appendChild(subjectElement);

            var dateElement = document.createElement('div');
            dateElement.className='date';
            dateElement.innerHTML=messages[i].date;
            senderElement.appendChild(dateElement);

            var bodyElement = document.createElement('div');
            bodyElement.className='body';
            bodyElement.innerHTML=messages[i].body;
            senderElement.appendChild(bodyElement);
           
      		}
      		return messages;
      	}

 		mail(geemails);

      var emailMessages = document.getElementsByClassName('email');
      for(var j=0; j<emailMessages.length; j++){
         emailMessages[j].addEventListener('click', showMessage);
      }

      function showMessage(event){
         var showBody=this.querySelectorAll('.body')[0];
         if(showBody.classList.contains('show')===false){
            return showBody.classList.add('show');
         }
         else{
            return showBody.classList.remove('show');
         }
      }


      var msgCounter = document.getElementById('count');
      msgCounter = geemails.length;
      var totalCount = document.createTextNode(msgCounter);
      count.appendChild(totalCount);

      
      function addNewMessage(){
      console.log(getNewMessage());
      console.log(getNewMessage().sender);
      console.log(getNewMessage().date);
      console.log(getNewMessage().body);
      console.log(getNewMessage().subject);

         var newMessage = getNewMessage();

            msgCounter++;
            count.innerHTML = msgCounter;

            var emailElement = document.createElement('div');
            emailElement.className='email';
            document.getElementById('main').appendChild(emailElement);

            var senderElement = document.createElement('div');
            senderElement.className='sender';
            senderElement.innerHTML=newMessage.sender;
            emailElement.appendChild(senderElement);

            var subjectElement = document.createElement('div');
            subjectElement.className='subject';
            subjectElement.innerHTML=newMessage.subject;
            senderElement.appendChild(subjectElement);

            var dateElement = document.createElement('div');
            dateElement.className='date';
            dateElement.innerHTML=newMessage.date;
            senderElement.appendChild(dateElement);

            var bodyElement = document.createElement('div');
            bodyElement.className='body';
            bodyElement.innerHTML=newMessage.body;
            senderElement.appendChild(bodyElement);

            var emailMessages = document.getElementsByClassName('email');
      for(var j=0; j<emailMessages.length; j++){
         emailMessages[j].addEventListener('click', showMessage);
      }

      function showMessage(event){
         var showBody=this.querySelectorAll('.body')[0];
         if(showBody.classList.contains('show')===false){
            return showBody.classList.add('show');
         }
         else{
            return showBody.classList.remove('show');
         }
      }


      }

      setInterval(addNewMessage,5000);



        // ALL OF YOUR JAVASCRIPT CODE SHOULD GO HERE. 
        // We have to use window.onload so your JavaScript doesn't execute until the page has loaded and all HTML has been downloaded to your browser
        
      };
    </script>
	</head>
	<body>
		<div id="welcome"></div>
			<p id ="inbox">Inbox: <span id ="count"></p></span>
		<div class="container" id="main"></div>
      <!-- <a href="body" onclick="toggle_visibility('body');"></a> -->

		
	</body>
</html>