<html>
	<head>
	<meta charset="UTF-8">
	<title>GeeMail Inbox</title>
		<script src="js/mail-generator.js"></script>
		<link href="css/style.css" rel="stylesheet" media="screen">
       <link rel="icon" href="/img/favicon.ico" type="image/gif"> 
    <script>
      window.onload = function(){

      	function email(messages){
      		for(var i=0; i<messages.length; i++){
            console.log(messages[i]);
            console.log(messages[i].subject);
            console.log(messages[i].body);
            console.log(messages[i].date);
            console.log(messages[i].sender);

            var emailElement = document.createElement('div');
            emailElement.className='email';
            document.getElementById('main').appendChild(emailElement);

            var senderElement = document.createElement('div');
            senderElement.className='sender';
            senderElement.innerHTML=messages[i].sender;
            emailElement.appendChild(senderElement);

            var subjectElement = document.createElement('div');
            subjectElement.className='subject';
            subjectElement.innerHTML=messages[i].subject;
            senderElement.appendChild(subjectElement);

            var bodyElement = document.createElement('div');
            bodyElement.className='body';
            bodyElement.innerHTML=messages[i].body;
            senderElement.appendChild(bodyElement);

            var dateElement = document.createElement('div');
            dateElement.className='date';
            dateElement.innerHTML=messages[i].date;
            senderElement.appendChild(dateElement);
           
      		}
      		return messages;
      	}

 		email(geemails);

      var emailMessages = document.getElementsByClassName('email');
      for(var j=0; j<emailMessages.length; j++){
         emailMessages[j].addEventListener('click', showMessage);
      }

      function showMessage(event){
         var showBody=this.querySelectorAll('.body')[0];
         if(showBody.classList.contains('show')===false){
            return showBody.classList.add('show');
         }
         else{
            return showBody.classList.remove('show');
         }
      }


      var inboxCount = document.getElementById('count');
      inboxCount = geemails.length;
      var totalCount = document.createTextNode(inboxCount);
      count.appendChild(totalCount);


      var newMsg = setInterval(newMessage, 5000);

      function newMessage(){
         console.log(getNewMessage());

         var getMsg = document.createElement('div');
         getMsg.className='newGetMsg';
         document.getElementById('main');
         getMsg.innerHTML=getNewMessage();
         main.appendChild(getMsg);
      }


      newMessage(getNewMessage);



        // ALL OF YOUR JAVASCRIPT CODE SHOULD GO HERE. 
        // We have to use window.onload so your JavaScript doesn't execute until the page has loaded and all HTML has been downloaded to your browser
        
      };
    </script>
	</head>
	<body>
		<div id="welcome">
			<p id ="inbox">Inbox: <span id ="count"></p></span>
		<div class="container" id="main"></div>
      <!-- <a href="body" onclick="toggle_visibility('body');"></a> -->

		
	</body>
</html>